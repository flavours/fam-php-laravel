#!/usr/bin/env php
<?php

require("/fam-php/vendor/autoload.php");

use Symfony\Component\Yaml\Yaml;
use Symfony\Component\Yaml\Exception\ParseException;

function check()
{
    $stdin = stream_get_contents(STDIN);
    call_parent($stdin);
}

function call_parent($stdin)
{
    $descriptorspec = array(
        0 => ["pipe", "r"],
        1 => ["pipe", "w"],
        2 => ["file", "/tmp/error-output.txt", "a"]
    );

    $process = proc_open('/fam-php/bin/check', $descriptorspec, $pipes);

    if (is_resource($process)) {
        fwrite($pipes[0], $stdin);
        fclose($pipes[0]);
        fclose($pipes[1]);
        proc_close($process);
    }
}

check();
